# =============================================================================
# Flow Workflow: General Reconnaissance
# =============================================================================
# Running default reconnaissance routine for domain targets.
# Executes subdomain-enum enumeration, probing, fingerprinting, screenshots,
# spidering, vulnerability scanning, directory bruteforcing, and port scanning.
# =============================================================================

# -----------------------------------------------------------------------------
# WORKFLOW-LEVEL FIELDS
# -----------------------------------------------------------------------------

kind: flow
name: general
description: Full-spectrum recon - subdomains, fingerprints, vulns, and more
tags: recon, domain

# -----------------------------------------------------------------------------
# PARAMS SECTION
# -----------------------------------------------------------------------------
params:
  - name: enableDnsBruteFocing
    default: "false"

# -----------------------------------------------------------------------------
# DEPENDENCIES SECTION
# -----------------------------------------------------------------------------
dependencies:
  variables:
    - name: Target
      type: domain
      required: true

# -----------------------------------------------------------------------------
# MODULES SECTION
# Execution order with dependencies
# -----------------------------------------------------------------------------
modules:
  # ===========================================================================
  # Phase 1: subdomain-enum Enumeration
  # ===========================================================================
  - name: subdomain-enum
    path: common/subdomain-enum.yaml

  # ===========================================================================
  # Phase 2: Probing
  # ===========================================================================
  - name: dns-probing
    path: common/dns-probing.yaml
    depends_on:
      - subdomain-enum

  # ===========================================================================
  # Phase 3: Fingerprinting
  # ===========================================================================
  - name: http-fingerprint
    path: common/http-fingerprint.yaml
    depends_on:
      - dns-probing

  # ===========================================================================
  # Phase 4: Screenshots
  # ===========================================================================
  - name: screenshot
    path: common/screenshot.yaml
    depends_on:
      - http-fingerprint

  # ===========================================================================
  # Phase 5: Archiving
  # ===========================================================================
  - name: archive
    path: common/archive.yaml
    depends_on:
      - http-fingerprint

  # ===========================================================================
  # Phase 6: IP Space Enumeration
  # ===========================================================================
  - name: ipspace
    path: common/ipspace.yaml
    depends_on:
      - http-fingerprint

  # ===========================================================================
  # Phase 7: Vulnerability Scanning
  # ===========================================================================
  - name: vulnerability-scan
    path: common/vulnerability-scan.yaml
    depends_on:
      - http-fingerprint

  # ===========================================================================
  # Phase 8: Port Scanning
  # ===========================================================================
  - name: portscan
    path: common/portscan.yaml
    depends_on:
      - http-fingerprint

  # ===========================================================================
  # Phase 9: Content Discovery
  # ===========================================================================
  - name: content-discovery
    path: common/content-discovery.yaml
    depends_on:
      - http-fingerprint
